---
/**
 * FullscreenLayout
 * Fullscreen page layout with fixed header
 * No container - content displays fullscreen
 * Suitable for homepage fullscreen scrolling
 */
import HeadMeta from '../../components/common/HeadMeta.astro'
import Header from '../../components/common/Header.astro'
import ThemeToggle from '../../components/common/ThemeToggle.astro'
import Background from '../../components/common/Background.astro'

import { createTheme, themeToCSSVars } from '../../theme'
import { themeConfig } from '../../data/theme.config'

import '../../styles/cards.css'

const {
  title = 'My Website',
  description = 'Record and Share',
  ogImage,
} = Astro.props as { 
  title?: string; 
  description?: string; 
  ogImage?: string;
}

const THEME = createTheme(themeConfig)
---

<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    
    <script is:inline>
      (function() {
        const storageKey = 'theme';
        const theme = localStorage.getItem(storageKey);
        
        if (theme && theme !== 'system') {
          document.documentElement.setAttribute('data-theme', theme);
        }
        else {
          const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
          if (prefersDark) {
            document.documentElement.setAttribute('data-theme', 'dark');
          } else {
            document.documentElement.setAttribute('data-theme', 'light');
          }
        }
      })();
    </script>
    
    <HeadMeta {title} {description} {ogImage} />

    <style is:inline set:html={themeToCSSVars(THEME)}></style>

    <style is:inline>
      body{
        min-height:100vh; margin:0;
        display: flex;
        flex-direction: column;
        background: var(--md-sys-color-background);
        color: var(--md-sys-color-on-background);
        font-family: var(--font-sans);
        line-height: var(--leading);
        font-size: var(--text-base);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        overflow: hidden;
      }
      
      main {
        flex: 1;
        overflow: hidden;
        position: relative;
        height: calc(100vh - 4rem);
        margin-top: 0;
      }
      
      a{ 
        color: inherit; 
        text-decoration: none; 
        transition: all .3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      a:hover{ color: var(--md-sys-color-primary); }
      
      /* Smooth scrolling behavior */
      html{ scroll-behavior: smooth; }
      
      /* Global border-radius inheritance */
      * {
        border-radius: inherit;
      }
      
      /* Glass effect with backdrop-filter support */
      @supports (backdrop-filter: blur(20px)) {
        .glass-effect {
          backdrop-filter: blur(20px) saturate(180%);
          -webkit-backdrop-filter: blur(20px) saturate(180%);
        }
      }
      
      /* Float-up animation keyframes */
      @keyframes float-up {
        0% { transform: translateY(0); }
        100% { transform: translateY(-2px); }
      }
      
      /* MD3 icon button styles (compact and refined) */
      .icon-btn{
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 2.25rem;
        height: 2.25rem;
        border-radius: 0.5rem;
        border: 1px solid var(--md-sys-color-outline);
        border-opacity: 0.1;
        background: var(--md-sys-color-surface-variant);
        background-opacity: 0.3;
        color: var(--md-sys-color-on-surface);
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        backdrop-filter: blur(8px);
      }
      .icon-btn:hover{
        background: var(--md-sys-color-primary-container);
        background-opacity: 0.4;
        color: var(--md-sys-color-on-primary-container);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      }
      .icon-btn:active{
        transform: translateY(0);
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      }
      
      /* Icon size optimization for better balance */
      .icon-btn i {
        font-size: 1.25rem;
      }
    </style>
  </head>

  <body class="antialiased min-h-dvh grid grid-rows-[auto,1fr]">
    <!-- Unified background -->
    <Background />
    
    <!-- Header - fixed top -->
    <Header>
      <ThemeToggle />
      <slot name="header-extra" />
    </Header>

    <!-- Main content area - fullscreen display -->
    <main class="overflow-auto relative min-h-0">
        <slot />
    </main>

    <!-- Footer slot - pages decide whether and how to display -->
    <slot name="footer" />
  </body>
</html>
