---
/**
 * SiteInfoSection Component
 * Site information section for homepage
 * Displays tech stack, statistics, and footer
 */
import { aboutConfig } from '../../data/user.config';
import { getArchiveStats } from '../../utils/blog';
import Footer from '../common/Footer.astro';

const stats = await getArchiveStats();

const statCards = [
  {
    icon: 'i-carbon:document',
    value: stats.totalPosts,
    label: 'site.stats.articles',
    gradient: 'from-blue-500/20 to-cyan-500/20',
    color: 'text-blue-500',
  },
  {
    icon: 'i-carbon:tag',
    value: stats.totalTags,
    label: 'site.stats.tags',
    gradient: 'from-purple-500/20 to-pink-500/20',
    color: 'text-purple-500',
  },
  {
    icon: 'i-carbon:text-font',
    value: `${Math.round(stats.totalWords / 1000)}K`,
    label: 'site.stats.words',
    gradient: 'from-green-500/20 to-emerald-500/20',
    color: 'text-green-500',
  },
  {
    icon: 'i-carbon:calendar',
    value: stats.postsThisYear,
    label: 'site.stats.thisYear',
    gradient: 'from-orange-500/20 to-red-500/20',
    color: 'text-orange-500',
  },
];
---

<div class="h-full box-border flex flex-col px-4 py-6 overflow-y-auto">
  <div class="site-info-section flex-shrink-0 max-w-6xl mx-auto w-full">
    <!-- Section Header -->
    <div class="section-header text-center mb-6 relative">
      <div class="absolute inset-0 -z-10 opacity-30">
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-gradient-to-br from-[var(--md-sys-color-primary)]/10 to-[var(--md-sys-color-tertiary)]/10 rounded-full blur-3xl"></div>
      </div>
      
      <h2 class="section-title inline-flex items-center justify-center gap-2 text-2xl md:text-3xl font-700 text-[var(--md-sys-color-on-surface)] mb-2">
        <span class="icon-wrapper inline-flex items-center justify-center w-10 h-10 bg-gradient-to-br from-[var(--md-sys-color-primary-container)] to-[var(--md-sys-color-tertiary-container)] rounded-xl">
          <i class="i-carbon:information text-xl text-[var(--md-sys-color-primary)]"></i>
        </span>
        <span class="bg-gradient-to-r from-[var(--md-sys-color-primary)] to-[var(--md-sys-color-tertiary)] bg-clip-text text-transparent" data-i18n="site.title">
          关于本站
        </span>
      </h2>
      <p class="section-subtitle text-xs md:text-sm text-[var(--md-sys-color-on-surface-variant)] font-500" data-i18n="site.subtitle">
        {aboutConfig.site.description}
      </p>
      
      <!-- 装饰线条 -->
      <div class="flex items-center justify-center gap-2 mt-3">
        <div class="w-12 h-0.5 bg-gradient-to-r from-transparent to-[var(--md-sys-color-primary)]/50"></div>
        <div class="w-2 h-2 rounded-full bg-[var(--md-sys-color-primary)]"></div>
        <div class="w-12 h-0.5 bg-gradient-to-l from-transparent to-[var(--md-sys-color-primary)]/50"></div>
      </div>
    </div>

    <!-- 主要内容区 -->
    <div class="site-content space-y-4">
      <!-- 网站统计 - 美化版 -->
      <div class="stats-grid grid gap-3 grid-cols-2 lg:grid-cols-4">
        {statCards.map((stat, index) => (
          <div 
            class="stat-card group relative animate-scale-in"
            style={`animation-delay: ${index * 100}ms;`}
          >
            <!-- 装饰性渐变背景 -->
            <div class={`absolute inset-0 bg-gradient-to-br ${stat.gradient} opacity-0 group-hover:opacity-100 transition-opacity duration-500 rounded-xl`}></div>
            
            <!-- 右上角光晕 -->
            <div class="absolute -top-6 -right-6 w-20 h-20 bg-gradient-to-br from-[var(--md-sys-color-primary)]/10 to-[var(--md-sys-color-tertiary)]/10 rounded-full blur-2xl group-hover:scale-150 transition-transform duration-500"></div>
            
            <div class="relative z-10 flex items-center gap-3 p-3 md:p-4 bg-gradient-to-br from-[var(--md-sys-color-surface-container-low)]/80 to-[var(--md-sys-color-surface-container)]/80 backdrop-blur-md border border-[var(--md-sys-color-outline-variant)]/50 rounded-xl transition-all duration-300 group-hover:border-[var(--md-sys-color-primary)] group-hover:-translate-y-1 group-hover:shadow-xl">
              <div class={`stat-icon w-10 h-10 md:w-12 md:h-12 flex items-center justify-center bg-gradient-to-br from-[var(--md-sys-color-primary-container)] to-[var(--md-sys-color-tertiary-container)] rounded-lg flex-shrink-0 group-hover:scale-110 transition-transform duration-300`}>
                <i class={`${stat.icon} text-lg md:text-xl ${stat.color} group-hover:animate-pulse`}></i>
              </div>
              <div class="stat-info flex-1">
                <div class="stat-value text-xl md:text-2xl font-700 text-[var(--md-sys-color-on-surface)] leading-none mb-1 group-hover:scale-105 transition-transform duration-300">{stat.value}</div>
                <div class="stat-label text-xs md:text-sm text-[var(--md-sys-color-on-surface-variant)] font-500" data-i18n={stat.label}></div>
              </div>
            </div>
          </div>
        ))}
      </div>

      <!-- 技术栈 - 美化版 -->
      <div class="tech-stack-section relative p-4 md:p-5 bg-gradient-to-br from-[var(--md-sys-color-surface-container-low)]/80 to-[var(--md-sys-color-surface-container)]/80 backdrop-blur-md border border-[var(--md-sys-color-outline-variant)]/50 rounded-xl overflow-hidden animate-fade-in" style="animation-delay: 400ms;">
        <!-- 装饰性背景 -->
        <div class="absolute top-0 right-0 w-40 h-40 bg-gradient-to-br from-[var(--md-sys-color-primary)]/5 to-transparent rounded-full blur-3xl"></div>
        
        <div class="relative z-10">
          <div class="tech-header flex items-center justify-between mb-3">
            <div class="flex items-center gap-2">
              <div class="icon-wrapper inline-flex items-center justify-center w-8 h-8 bg-gradient-to-br from-[var(--md-sys-color-primary-container)] to-[var(--md-sys-color-tertiary-container)] rounded-lg">
                <i class="i-carbon:code text-base text-[var(--md-sys-color-primary)]"></i>
              </div>
              <h3 class="text-lg md:text-xl font-700 text-[var(--md-sys-color-on-surface)]" data-i18n="site.tech.title">技术栈</h3>
            </div>
            <span class="tech-badge inline-flex items-center gap-1 px-2 py-1 text-xs font-600 bg-gradient-to-r from-[var(--md-sys-color-primary-container)]/60 to-[var(--md-sys-color-tertiary-container)]/60 text-[var(--md-sys-color-on-primary-container)] rounded-full">
              <i class="i-carbon:checkmark-filled text-xs"></i>
              <span data-i18n="site.tech.subtitle">现代化</span>
            </span>
          </div>
          <p class="tech-description text-xs md:text-sm text-[var(--md-sys-color-on-surface-variant)] mb-4 leading-relaxed" data-i18n="site.tech.description">{aboutConfig.site.builtWith}</p>
          
          <div class="tech-grid grid gap-2 md:gap-3 grid-cols-1 md:grid-cols-2 lg:grid-cols-3">
            {aboutConfig.site.techStack.map((tech, index) => (
              <a 
                href={tech.url} 
                target="_blank" 
                rel="noopener noreferrer"
                class="tech-card group/tech relative animate-scale-in"
                style={`animation-delay: ${index * 80 + 500}ms;`}
              >
                <!-- 装饰性渐变背景 -->
                <div class="absolute inset-0 bg-gradient-to-br from-[var(--md-sys-color-primary)]/5 to-transparent opacity-0 group-hover/tech:opacity-100 transition-opacity duration-300 rounded-lg"></div>
                
                <div class="relative z-10 flex items-center gap-3 p-3 bg-[var(--md-sys-color-surface-container)]/70 backdrop-blur-sm border border-[var(--md-sys-color-outline-variant)]/50 rounded-lg transition-all duration-300 group-hover/tech:bg-[var(--md-sys-color-surface-container-high)]/70 group-hover/tech:border-[var(--md-sys-color-primary)] group-hover/tech:-translate-y-1 group-hover/tech:shadow-lg no-underline">
                  <i class={`${tech.icon} text-2xl text-[var(--md-sys-color-primary)] flex-shrink-0 group-hover/tech:scale-110 transition-transform duration-300`}></i>
                  <div class="tech-info flex-1 min-w-0">
                    <h4 class="text-sm font-600 text-[var(--md-sys-color-on-surface)] group-hover/tech:text-[var(--md-sys-color-primary)] transition-colors leading-snug mb-0.5">{tech.name}</h4>
                    <p class="text-xs text-[var(--md-sys-color-on-surface-variant)]/80 leading-snug m-0 line-clamp-1">{tech.description}</p>
                  </div>
                  <i class="i-carbon:arrow-up-right text-sm text-[var(--md-sys-color-on-surface-variant)] opacity-0 group-hover/tech:opacity-100 transition-all duration-300 transform translate-x-1 -translate-y-1 group-hover/tech:translate-x-0 group-hover/tech:translate-y-0"></i>
                </div>
              </a>
            ))}
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer 固定在底部 - 使用 mt-auto 自动推到底部 -->
  <div class="site-footer flex-shrink-0 mt-auto max-w-6xl mx-auto w-full">
    <Footer />
  </div>
</div>

<style>
  /* Text truncation utility */
  .line-clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Animation definitions */
  @keyframes fade-in {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes scale-in {
    from {
      opacity: 0;
      transform: scale(0.9);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  .animate-fade-in {
    opacity: 0;
    animation: fade-in 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  }

  .animate-scale-in {
    opacity: 0;
    animation: scale-in 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  }

  /* Icon wrapper pulsing glow animation */
  .section-header .icon-wrapper {
    animation: pulse-glow 2s ease-in-out infinite;
  }
  
  @keyframes pulse-glow {
    0%, 100% {
      box-shadow: 0 0 0 0 var(--md-sys-color-primary);
      opacity: 1;
    }
    50% {
      box-shadow: 0 0 20px 5px var(--md-sys-color-primary);
      opacity: 0.8;
    }
  }

  /* Responsive optimization */
  @media (max-width: 1024px) {
    .stats-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (max-width: 640px) {
    .stats-grid {
      grid-template-columns: 1fr;
    }
    
    .tech-grid {
      grid-template-columns: 1fr !important;
    }
  }
</style>
